!function(o){"use strict";function e(o,e){var t=this;t.$element=o,t.element=o[0],t.isLoading=!1,t.init(e)}function t(e,t,n){o.ajax({type:"POST",url:e.url,data:e.data,timeout:e.timeout||3e3,success:t,error:n||function(o){alert(o)}})}var n=o(window),l=o(document);n.height();o.fn.xload=function(o){return new e(this,o)},e.prototype.init=function(e){var t=this;t.opts=o.extend(!0,{loadFn:t.noop,distance:50,needAutoLoad:!0,scrollArea:window,html_nomore:'<p class="x-nomore">没有更多数据</p>',html_loading:'<p class="x-loading">正在加载...</p>'},e),t.$nomore=o(t.opts.html_nomore),t.$loading=o(t.opts.html_loading),t.opts.scrollArea==window?(t.$scrollArea=n,t.scrollHeight=l.height(),t.clientHeight=document.documentElement.clientHeight):(t.$scrollArea=t.$element,t.scrollHeight=t.element.scrollHeight,t.clientHeight=t.element.clientHeight),n.on("resize",function(){}),t.autoLoad(),t.$scrollArea.on("scroll",t.handleScroll.bind(t))},e.prototype.noop=function(){},e.prototype.autoLoad=function(){var o=this;o.opts.needAutoLoad&&o.$scrollArea.height()-o.opts.distance<=o.clientHeight?o.handleLoad(o.autoLoad):o.opts.needAutoLoad=!1},e.prototype.handleScroll=function(){var o=this;!o.isLoading&&o.scrollHeight-o.opts.distance<=o.clientHeight+o.$scrollArea.scrollTop()&&(o.isLoading=!0,o.handleLoad())},e.prototype.handleLoad=function(o){var e=this;e.$element.append(e.$loading),t(e.opts.ajaxParams,function(o){e.isLoading=!1,e.$loading.remove(),e.opts.onAjaxSuccess(o),e.refreshScrollHeight()})},e.prototype.refreshScrollHeight=function(){var o=this;o.opts.scrollArea==window?o.scrollHeight=l.height():o.scrollHeight=o.element.scrollHeight}}(window.Zepto||window.jQuery);